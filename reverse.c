#include "header.h"

void reverse_data()
{
    int i;
    FILE *fp = fopen(main_path, "a");
    fprintf(fp, "\n/******************** Reverse Data ************************/\n");
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    fprintf(fp, "void reverse_data(%s**ptr)\n{\n", alias_name);
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    // if condition
    fprintf(fp, "if (*ptr == NULL)\n{\nprintf(\"\\033[33mNo Record found\\n\\033[0m\");\nreturn;\n}\n");
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    // variables
    fprintf(fp, "%s *p1, *p2, temp;\n", alias_name);
    fprintf(fp, "p1 = p2 = *ptr;\n");
    fprintf(fp, " int i, j, c = count_node(*ptr);\n");
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    // body part
    fprintf(fp, "for (i = 0; i < c / 2; i++)\n{\np2 = p1;\n");
    fprintf(fp, "for (j = i; j < c - i - 1; j++)\np2 = p2->next;\n");
    for (i = 0; i < no_of_members; i++)
    {
        if (types_member[i] == 4)
        {
            fprintf(fp, "strcpy(temp.%s,p1->%s);\n", member[i], member[i]);
        }
        else
        {
            fprintf(fp, "temp.%s=p1->%s;\n", member[i], member[i]);
        }
    }
    fprintf(fp, "\n");
    for (i = 0; i < no_of_members; i++)
    {
        if (types_member[i] == 4)
        {
            fprintf(fp, "strcpy(p1->%s,p2->%s);\n", member[i], member[i]);
        }
        else
        {
            fprintf(fp, "p1->%s=p2->%s;\n", member[i], member[i]);
        }
    }
    fprintf(fp, "\n");
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    for (i = 0; i < no_of_members; i++)
    {
        if (types_member[i] == 4)
        {
            fprintf(fp, "strcpy(p2->%s,temp.%s);\n", member[i], member[i]);
        }
        else
        {
            fprintf(fp, "p2->%s=temp.%s;\n", member[i], member[i]);
        }
    }
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    fprintf(fp, "\np1 = p1->next;\n}\n");
    // body End
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    fprintf(fp, "printf(\"\\033[33mData Reverse Sucessfully\\033[0m\\n\");\n");
    fprintf(fp, "}\n");
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    fclose(fp);
}

void reverse_link()
{
    int i;
    FILE *fp = fopen(main_path, "a");
    fprintf(fp, "\n//--------------------------------- REVERSE LINK ------------------------------\n");
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    fprintf(fp, "void reverse_link(%s**ptr)\n{\n", alias_name);
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    // if condition
    fprintf(fp, "if (*ptr == NULL)\n{\nprintf(\"\\033[33mNo Record found\\n\\033[0m\");\nreturn;\n}\n");
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    // variables
    fprintf(fp, " int i=0, c = count_node(*ptr);\n");
    fprintf(fp, "%s **node=malloc(sizeof(%s *)*c);  // dynamic memory allocating to store address\n", alias_name, alias_name);
    fprintf(fp, "%s *temp = *ptr;      // assign starting add\n", alias_name);
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    // body part
    fprintf(fp, " while (temp)\n{\nnode[i++] = temp; // storing address of every node into node arry\ntemp = temp->next;\n}\n");
    fprintf(fp, " for (i = 1; i < c; i++)\nnode[i]->next = node[i - 1]; // reversing link\n");
    fprintf(fp, "node[0]->next = 0;               // assign 0 addres to last node\n");
    fprintf(fp, "*ptr = node[c - 1];              // update headptr\n");
    // body End
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    fprintf(fp, "printf(\"\\033[33mReverse Link Sucessfully\\033[0m\\n\");\n");
    fprintf(fp, "}\n");
    //---------------------------------------------------------------------------------------
    //
    //---------------------------------------------------------------------------------------
    fclose(fp);
}
